# üîê Claude MAX Subscription Authentication

## –ö–∞–∫ —É—Å—Ç—Ä–æ–µ–Ω–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –≤ Claude Code —Å MAX –ø–æ–¥–ø–∏—Å–∫–æ–π

### ‚úÖ –ì–ª–∞–≤–Ω—ã–π –≤—ã–≤–æ–¥

Claude Code —Å MAX –ø–æ–¥–ø–∏—Å–∫–æ–π —Ä–∞–±–æ—Ç–∞–µ—Ç **–ë–ï–ó API –∫–ª—é—á–µ–π** —á–µ—Ä–µ–∑ –≥–ª–æ–±–∞–ª—å–Ω—É—é —É—Å—Ç–∞–Ω–æ–≤–∫—É!

## üîç –ê–Ω–∞–ª–∏–∑ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

### 1. –¢–∏–ø—ã –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –≤ Claude Code

Claude Code –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–ø–æ—Å–æ–±–æ–≤ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏:

```json
{
  "ANTHROPIC_API_KEY": "–ü–ª–∞—Ç–Ω—ã–π API –∫–ª—é—á ($20+/–º–µ—Å—è—Ü)",
  "ANTHROPIC_AUTH_TOKEN": "–ö–∞—Å—Ç–æ–º–Ω—ã–π —Ç–æ–∫–µ–Ω –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏", 
  "MAX_SUBSCRIPTION": "–í—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ –±—Ä–∞—É–∑–µ—Ä",
  "apiKeyHelper": "–°–∫—Ä–∏–ø—Ç –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ç–æ–∫–µ–Ω–æ–≤"
}
```

### 2. MAX –ø–æ–¥–ø–∏—Å–∫–∞ vs API –∫–ª—é—á–∏

| –ü–∞—Ä–∞–º–µ—Ç—Ä | MAX Subscription | API Key |
|----------|------------------|---------|
| **–°—Ç–æ–∏–º–æ—Å—Ç—å** | ~$20/–º–µ—Å—è—Ü | $20+/–º–µ—Å—è—Ü –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ |
| **–£—Å—Ç–∞–Ω–æ–≤–∫–∞** | `npm install -g @anthropic-ai/claude-code` | –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è –æ–∫—Ä—É–∂–µ–Ω–∏—è |
| **–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è** | –ß–µ—Ä–µ–∑ –±—Ä–∞—É–∑–µ—Ä (–æ–¥–Ω–æ—Ä–∞–∑–æ–≤–æ) | –ö–∞–∂–¥—ã–π –∑–∞–ø—Ä–æ—Å |
| **–ú–µ—Å—Ç–æ —Ö—Ä–∞–Ω–µ–Ω–∏—è** | Global npm | Environment variables |
| **–ü—É—Ç—å** | `/Users/laptop/.npm-global/bin/claude` | –õ—é–±–æ–π |

### 3. –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç MAX –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è

```bash
# 1. –ì–ª–æ–±–∞–ª—å–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞
npm install -g @anthropic-ai/claude-code

# 2. –ü–µ—Ä–≤–∏—á–Ω–∞—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è (—á–µ—Ä–µ–∑ –±—Ä–∞—É–∑–µ—Ä)
claude

# 3. –¢–æ–∫–µ–Ω —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ
# –í ~/.claude/ –∏–ª–∏ –ø–æ–¥–æ–±–Ω–æ–º
```

## üêõ –ü—Ä–æ–±–ª–µ–º–∞ –∫–æ—Ç–æ—Ä—É—é –º—ã —Ä–µ—à–∏–ª–∏

### –ò–∑–Ω–∞—á–∞–ª—å–Ω–∞—è –æ—à–∏–±–∫–∞

```json
{
  "is_error": true,
  "result": "Invalid API key ¬∑ Fix external API key"
}
```

### –ü—Ä–∏—á–∏–Ω–∞

Cynosure Bridge –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø—É—Ç—å:

```typescript
‚ùå const claudePath = '/Users/laptop/.claude/local/claude';  // –õ–æ–∫–∞–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è
‚úÖ const claudePath = '/Users/laptop/.npm-global/bin/claude'; // –ì–ª–æ–±–∞–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è
```

### –†–∞–∑–ª–∏—á–∏—è –≤–µ—Ä—Å–∏–π

#### –õ–æ–∫–∞–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è (`~/.claude/local/claude`)

- Wrapper script –¥–ª—è —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã—Ö –∑–∞–¥–∞—á
- –ù–µ –∏–º–µ–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ –≥–ª–æ–±–∞–ª—å–Ω–æ–π –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
- –¢—Ä–µ–±—É–µ—Ç –æ—Ç–¥–µ–ª—å–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

#### –ì–ª–æ–±–∞–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è (`~/.npm-global/bin/claude`)

- –ü–æ–ª–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ Claude Code
- –í—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —Å MAX –ø–æ–¥–ø–∏—Å–∫–æ–π
- –†–∞–±–æ—Ç–∞–µ—Ç "–∏–∑ –∫–æ—Ä–æ–±–∫–∏"

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –≤ –∫–æ–¥–µ

```typescript
// src/claude/api-client.ts
const claudePath = process.env.CLAUDE_PATH || '/Users/laptop/.npm-global/bin/claude';
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∏ Claude Code

–§–∞–π–ª—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:

- `~/.claude/settings.json` - –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
- `~/.claude/settings.local.json` - –õ–æ–∫–∞–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
- `~/.claude/CLAUDE.md` - Memory –∏ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

```bash
# –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
ANTHROPIC_API_KEY=        # –ù–ï –ù–£–ñ–ù–û –¥–ª—è MAX
ANTHROPIC_AUTH_TOKEN=     # –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π —Ç–æ–∫–µ–Ω

# –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
CLAUDE_PATH=              # –ö–∞—Å—Ç–æ–º–Ω—ã–π –ø—É—Ç—å –∫ CLI
CLAUDE_CODE_ENTRYPOINT=   # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ (cli/browser)
```

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —É—Å—Ç–∞–Ω–æ–≤–∫—É
which claude
# /Users/laptop/.npm-global/bin/claude

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤–µ—Ä—Å–∏—é  
claude --version
# @anthropic-ai/claude-code@1.0.21

# –¢–µ—Å—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
echo "test" | claude -p --output-format json
```

### –õ–æ–≥–∏ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

Claude –≤–µ–¥—ë—Ç –ª–æ–≥–∏ –≤ `~/.claude/logs/`:

```bash
tail -f ~/.claude/logs/monitor.log
cat ~/.claude/logs/health.json
```

### –°—Ç–∞—Ç—É—Å —á–µ—Ä–µ–∑ health endpoint

```bash
curl http://localhost:3000/health | jq '.claude_code_available'
# true
```

## üéØ –†–µ–∑—É–ª—å—Ç–∞—Ç —Ñ–∏–∫—Å–∞

### –î–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è ‚ùå

```bash
curl localhost:3000/v1/chat/completions
# {"error": {"message": "Internal server error"}}
```

### –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è ‚úÖ

```bash
curl localhost:3000/v1/chat/completions
# {
#   "id": "chatcmpl-...",
#   "choices": [{
#     "message": {
#       "content": "–ü—Ä–∏–≤–µ—Ç!"
#     }
#   }]
# }
```

## üí° –ö–ª—é—á–µ–≤—ã–µ –≤—ã–≤–æ–¥—ã

### ‚úÖ –ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å MAX –ø–æ–¥–ø–∏—Å–∫–æ–π

1. **–ì–ª–æ–±–∞–ª—å–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ Claude Code**
2. **–õ–æ–∫–∞–ª—å–Ω—ã–π —Å–µ—Ä–≤–µ—Ä Cynosure Bridge**
3. **Ngrok —Ç—É–Ω–Ω–µ–ª—å –¥–ª—è GitHub Actions**
4. **–ù–µ—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –≤ API –∫–ª—é—á–∞—Ö**

### ‚ùå –ß—Ç–æ –ù–ï —Ä–∞–±–æ—Ç–∞–µ—Ç

1. –õ–æ–∫–∞–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è Claude –±–µ–∑ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
2. API –∑–∞–ø—Ä–æ—Å—ã –±–µ–∑ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –ø—É—Ç–∏ –∫ CLI
3. Workflows –±–µ–∑ ngrok —Ç—É–Ω–Ω–µ–ª—è

### üîÆ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

1. **–í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≥–ª–æ–±–∞–ª—å–Ω—É—é —É—Å—Ç–∞–Ω–æ–≤–∫—É** –¥–ª—è production
2. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é CLAUDE_PATH** –¥–ª—è –≥–∏–±–∫–æ—Å—Ç–∏
3. **–ú–æ–Ω–∏—Ç–æ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏** —á–µ—Ä–µ–∑ health endpoints
4. **–ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è–π—Ç–µ Claude Code** –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

- [Claude Code Documentation](https://docs.anthropic.com/en/docs/claude-code)
- [Settings Reference](https://docs.anthropic.com/en/docs/claude-code/settings)
- [Security Guide](https://docs.anthropic.com/en/docs/claude-code/security)

---

**–ò—Ç–æ–≥**: MAX –ø–æ–¥–ø–∏—Å–∫–∞ –¥–∞—ë—Ç –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ Claude —á–µ—Ä–µ–∑ CLI –±–µ–∑ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö API –∫–ª—é—á–µ–π! üéâ
